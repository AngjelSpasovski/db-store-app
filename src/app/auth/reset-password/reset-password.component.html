<div class="container py-5" style="max-width:520px">
  <h2 class="mb-3">{{ 'RESET_PASSWORD' | translate}}</h2>

  <ng-container [ngSwitch]="state">
    <div *ngSwitchCase="'verifying'">{{ 'VERIFY_LINK' | translate }}</div>

    <form *ngSwitchCase="'ok'" [formGroup]="form" (ngSubmit)="submit()">
      <div class="mb-3">
        <label class="form-label">{{ 'NEW_PASSWORD' | translate }}</label>
        <input type="password" class="form-control"
               formControlName="password"
               [class.is-invalid]="form.touched && f['password'].invalid">
        <div class="invalid-feedback">{{ 'RESET_MIN_LENGTH' | translate }}</div>
      </div>

      <div class="mb-3">
        <label class="form-label">{{ 'CONFIRM_PASSWORD' | translate }}</label>
        <input type="password" class="form-control"
               formControlName="confirm"
               [class.is-invalid]="form.touched && (f['confirm'].invalid || form.errors?.['mismatch'])">
        <div class="invalid-feedback">{{ 'PASSWORD_MISMATCH' | translate }}</div>
      </div>

      <button class="btn btn-primary" type="submit" [disabled]="form.invalid">{{ 'SET_PASSWORD' | translate }}</button>
      <div class="form-text mt-2 text-danger" *ngIf="message">{{ message }}</div>
    </form>

    <div *ngSwitchCase="'saving'">{{ 'SAVING' | translate }}</div>

    <div *ngSwitchCase="'done'" class="alert alert-success">
      {{ 'PASSWORD_CHANGED' | translate }} <a routerLink="/login" [queryParams]="{ tab: 'login' }">{{ 'BACK_LOGIN' | translate }}</a>
    </div>

    <div *ngSwitchCase="'fail'" class="alert alert-danger">
      {{ message }} <a routerLink="/forgot-password">{{ 'REQUEST_NEW_LINK' | translate }}</a>
    </div>
  </ng-container>
</div>
